---
title: "Predicting the Weather"
output: 
  html_document:
    theme: cosmo
    code_folding: hide
    toc: true
    toc_float: true
---


```{r, include=FALSE}
library(tidyverse)
```

```{r, include=FALSE}
data.raw <- read_csv("C:/DataScience/Statistics-Notebook/Data/rex-weather.csv")
```


```{r, include = F}
data.actual <- data.raw %>% 
  select(Y, x_actual_max)
```

<br>
<br>

I'm using the `Actual Max Temp` (F) from $04/27$ to predict the `Actual Max Temp` (F) from $04/29$

<br>
<br>

#### Actual Max Temp (04/27)

```{r}
lm.actual <- lm(Y ~ x_actual_max, data = data.actual)
pander::pander(summary(lm.actual))
```

<br>



## Mathematical model

$$
\text{Max Actual Temp (04/29)} = 17.9 + 0.7 \ \times \ \text{Max Actual Temp (04/27)} + \epsilon_i 
$$

The hypothesis

$$
H_0: \beta_1 = 0
$$
$$
H_1: \beta_1 \neq 0
$$

shows that the slope is significant ($p = 0.002$), so we consider the relationship to be **meaningful**

<br>




The model also shows that for every degree increasing on `04/27`, the average `Y-value` will increase in 0.67F. <br>
When `04/27` marks 0F, the average temperature on `04/29` is 18F. <br>


```{r}
data.actual %>% 
  ggplot(aes(x_actual_max, Y)) +
  geom_point(color = "lightsteelblue4") +
  geom_smooth(method = "lm", se = T, color = "steelblue") +
  theme(panel.background = element_blank(),
        panel.grid = element_blank()) +
  labs(title = "Linear Regression",
       x = "Actual Max Temp (04/27)",
       y = "Actual Max Temp (04/29)")
```


<br>
<br>
<br>

## Predicting 04/29/**2019**

Saturday Actual Max Temp 04/27/2019 = 63F
<br><br>

The max actual temperature on Monday (04/29/2019) will be:

```{r}
sat <- 62

pred <- predict(lm.actual, data.frame(x_actual_max = sat), interval = "prediction")[1]
pander::pander(round(pred, 0))

```

```{r}
data.actual %>% 
  ggplot(aes(x_actual_max, Y)) +
  geom_point(color = "lightsteelblue4") +
  geom_smooth(method = "lm", se = F, color = "steelblue") +
  geom_point(y = pred, x = sat, color = "firebrick", size = 3) +
  theme(panel.background = element_blank(),
        panel.grid = element_blank(),
        plot.title = element_text(color = "firebrick")) +
  labs(title = "Prediction",
       x = "Actual Max Temp (04/27)",
       y = "Actual Max Temp (04/29)")
```


## **Assumptions**

```{r}
lm.actual %>% 
  ggplot(aes(lm.actual$fit, lm.actual$residuals)) +
  geom_point() +
  labs(title = "Residuals vs Fitted-values",
    subtitle = "It has a linear relation but the variance is not constant") +
  theme(panel.background = element_blank(),
        panel.grid = element_blank())
```

```{r}
qqnorm(data.actual$Y,
       ylab = "Observed", pch = 16, main = "Heavily tailed", sub = "The error term is not normally distributed")
qqline(data.actual$Y)
```





<br>
<br>

### Data

```{r}
DT::datatable(data.actual)
```





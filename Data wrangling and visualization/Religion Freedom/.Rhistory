filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average"),
stat = "identity", linetype = Issue, color = "black", alpha = .5)) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", linetype = Issue, color = "black", alpha = .5)) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", linetype = Issue, color = "black", alpha = .5) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(linetype = Issue), color = "black", alpha = .5) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(linetype = Issue), group = Country, color = "black", alpha = .5) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(linetype = Issue, group = Country), color = "black", alpha = .5) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(group = Country), color = "black", alpha = .5) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(group = Country), color = "black", alpha = .3) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(group = Country), color = "black", alpha = .1) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(group = Country), color = "black", alpha = .2) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "firebrick", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(group = Country), color = "black", alpha = .15) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "firebrick", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "chartreuse4", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(group = Country), color = "black", alpha = .15) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "chartreuse4", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
labs(y = "Level of Persecution") +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
saudi %>%
filter(Country == "Saudi Arabia") %>%
ggplot(aes(Year, Value)) +
geom_line(stat = "identity", aes(linetype = Issue), color = "darkgreen", size = 1.2) +
geom_line(data = saudi %>% filter(Country == "World Average"),
stat = "identity", aes(linetype = Issue), color = "black", size = 1) +
geom_line(data = saudi %>% filter(!Country %in% c("Saudi Arabia", "World Average")),
stat = "identity", aes(group = Country), color = "black", alpha = .15) +
geom_text(label = "Saudi Arabia", x = 2015, y = 6.5, color = "darkgreen", size = 3) +
geom_text(label = "World Average", x = 2015, y = 2.3, color = "black", size = 3) +
labs(y = "Level of Persecution") +
theme(legend.position = c(0.8,0.95),
legend.direction = "vertical",
legend.title = element_blank(),
legend.box.background = element_blank(),
legend.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.x = element_blank(),
axis.ticks = element_blank())
gif.saudi.gov <- saudi %>%
filter(Issue == "Government Restrictions") %>%
group_by(Year) %>%
mutate(rank = rank(Value, ties.method="first")) %>%
ungroup() %>%
mutate(saudi = ifelse(Country == "Saudi Arabia", 1, 0)) %>%
ggplot(aes(rank, group = Country, fill = Continent)) +
geom_bar(stat = 'identity', aes(y = Value, alpha = saudi)) +
geom_text(aes(label = Country, y = Value, alpha = saudi), position = position_dodge(0.1), size = 3) +
scale_alpha(range = c(0.5,1), guide = F) +
scale_fill_manual(values = colors) +
labs(subtitle = '{closest_state}',
y = "Government RestrictionsSocial Hostilities") +
coord_flip(expand = T) + #clip = "off", expand = FALSE) +
theme(axis.line.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
legend.position = "top",
legend.key.size = unit(0.4, "cm"),
legend.text = element_text(size = 8),
legend.title = element_text(size = 10, color = "black"),
title = element_text(size = 15, face = "bold", colour = "blue")) +
transition_states(Year, transition_length = 5, state_length = 1) +
ease_aes('cubic-in-out') +
#ease_aes('linear') +
#ease_aes('quadratic-in-out') +
enter_fade() +
exit_shrink()
animate(gif.saudi.gov, fps = 25, duration = 45, width = 800, height = 600, renderer = gifski_renderer("saudi_gov.gif"))
DT::datatable(saudi.raw)
# Scatterplot
p <- saudi.raw %>%
plot_ly(
x = ~`Social Hostilities`,
y = ~`Government Restrictions`,
size = ~ifelse(Country == "Saudi Arabia", 4, 1),
color = ~Continent,
frame = ~Year,
type = "scatter",
mode = "markers",
text = ~Country,
hoverinfo = "text",
showlegend = T
)
p %>%
animation_opts(frame = 1500, transition = 1000) %>%
animation_button(x = 1, xanchor = "right", y = 0, yanchor = "bottom") %>%
animation_slider(currentvalue = list(prefix = "Year ", font = list(color = "darkgreen"))
)
# Scatterplot
p <- saudi.raw %>%
plot_ly(
x = ~`Social Hostilities`,
y = ~`Government Restrictions`,
size = ~ifelse(Country == "Saudi Arabia", 4, 1),
color = ~Continent,
frame = ~Year,
type = "scatter",
mode = "markers",
text = ~Country,
hoverinfo = "text",
showlegend = T
)
p %>%
animation_opts(frame = 800, transition = 1000) %>%
animation_button(x = 1, xanchor = "right", y = 0, yanchor = "bottom") %>%
animation_slider(currentvalue = list(prefix = "Year ", font = list(color = "darkgreen"))
)
# Scatterplot
p <- saudi.raw %>%
plot_ly(
x = ~`Social Hostilities`,
y = ~`Government Restrictions`,
size = ~ifelse(Country == "Saudi Arabia", 4, 1),
color = ~Continent,
frame = ~Year,
type = "scatter",
mode = "markers",
text = ~Country,
hoverinfo = "text",
showlegend = T
)
p %>%
animation_opts(frame = 1000, transition = 1000) %>%
animation_button(x = 1, xanchor = "right", y = 0, yanchor = "bottom") %>%
animation_slider(currentvalue = list(prefix = "Year ", font = list(color = "darkgreen"))
)
# Scatterplot
p <- saudi.raw %>%
plot_ly(
x = ~`Social Hostilities`,
y = ~`Government Restrictions`,
size = ~ifelse(Country == "Saudi Arabia", 4, 1),
color = ~colors,
frame = ~Year,
type = "scatter",
mode = "markers",
text = ~Country,
hoverinfo = "text",
showlegend = T
)
p %>%
animation_opts(frame = 2000, transition = 2000) %>%
animation_button(x = 1, xanchor = "right", y = 0, yanchor = "bottom") %>%
animation_slider(currentvalue = list(prefix = "Year ", font = list(color = "darkgreen"))
)
# Scatterplot
p <- saudi.raw %>%
plot_ly(
x = ~`Social Hostilities`,
y = ~`Government Restrictions`,
size = ~ifelse(Country == "Saudi Arabia", 4, 1),
color = colors,
frame = ~Year,
type = "scatter",
mode = "markers",
text = ~Country,
hoverinfo = "text",
showlegend = T
)
p %>%
animation_opts(frame = 2000, transition = 2000) %>%
animation_button(x = 1, xanchor = "right", y = 0, yanchor = "bottom") %>%
animation_slider(currentvalue = list(prefix = "Year ", font = list(color = "darkgreen"))
)
# Scatterplot
p <- saudi.raw %>%
plot_ly(
x = ~`Social Hostilities`,
y = ~`Government Restrictions`,
size = ~ifelse(Country == "Saudi Arabia", 4, 1),
#color = ~Continent,
frame = ~Year,
type = "scatter",
mode = "markers",
text = ~Country,
hoverinfo = "text",
showlegend = T
) %>%
layout(colorway = colors)
p %>%
animation_opts(frame = 2000, transition = 2000) %>%
animation_button(x = 1, xanchor = "right", y = 0, yanchor = "bottom") %>%
animation_slider(currentvalue = list(prefix = "Year ", font = list(color = "darkgreen"))
)
colors
# Scatterplot
p <- saudi.raw %>%
plot_ly(
x = ~`Social Hostilities`,
y = ~`Government Restrictions`,
size = ~ifelse(Country == "Saudi Arabia", 4, 1),
color = ~Continent,
colors = ~colors,
frame = ~Year,
type = "scatter",
mode = "markers",
text = ~Country,
hoverinfo = "text",
showlegend = T
)
p %>%
animation_opts(frame = 2000, transition = 2000) %>%
animation_button(x = 1, xanchor = "right", y = 0, yanchor = "bottom") %>%
animation_slider(currentvalue = list(prefix = "Year ", font = list(color = "darkgreen"))
)
# Scatterplot
p <- saudi.raw %>%
plot_ly(
x = ~`Social Hostilities`,
y = ~`Government Restrictions`,
size = ~ifelse(Country == "Saudi Arabia", 4, 1),
color = ~Continent,
colors = ~colors,
frame = ~Year,
type = "scatter",
mode = "markers",
text = ~Country,
hoverinfo = "text",
showlegend = T
)
p %>%
animation_opts(frame = 2000, transition = 2000) %>%
# animation_button(x = 1, xanchor = "right", y = 0, yanchor = "bottom") %>%
animation_slider(currentvalue = list(prefix = "Year ", font = list(color = "darkgreen"))
)
library(tidyverse)
###
# Loading
###
news.raw <- read_csv("https://query.data.world/s/hivb5gv236zad627wshrd53cih7gb6")
###
# Wrangling
###
news <- news.raw %>%
mutate(Week = lubridate::week(Date),
Month = lubridate::month(Date),
Year = lubridate::year(Date))
news.oca <- news %>%
#filter(Date >= 'xx', Date <= 'xx', College %in% 'xx', Department %in% 'xx')
group_by(Year, Week) %>%
# Grouping and summarizing by group
mutate(Opens = sum(Opens, na.rm = T),
Clicks = sum(Clicks, na.rm = T),
`HS Activations` = sum(`HS Activations`, na.rm = T)) %>%
ungroup() %>%
unique()
###############
news.oca <- news.oca %>% filter(Date < "2019-05-03")
##############
###
# Globals
###
G.my_theme <- theme(panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
# Colors
G.cols_total <- "cornflowerblue"
G.cols <- c("CALS" = "",
"CBC" = "",
"CEHD" = "",
"CFIS" = "",
"CLL" = "",
"CPSE" = "",
"CPVA" = "")
# Geom_line size, colors
G.line_size <- 1.3
G.line_main_col <- "cornflowerblue"
# Geom_text VERTICAL position for HIGH values
G.label_pos_h <- -.5
# Geom_text VERTICAL position for LOW values
G.label_pos_l <- .9
# Geom_text HORIZONTAL position for LAST values
G.label_pos_last <- -.1
# Geom_text size for HIGH values
G.label_size_h <- 4
# Geom_text size for LOW values
G.label_size_l <- 2.5
# Geom_text colors
G.label_h_col <- "cornflowerblue"
G.label_l_col <- "firebrick1"
G.label_last_col <- "darkgoldenrod4"
news.o <- news.oca %>%
# Identifying highest and lowest values
select(Date, Semester, Type, College, Department, Recipients, Opens, Week, Month, Year) %>%
mutate(High_Low = ifelse(Opens == max(Opens), "h",
ifelse(Opens == min(Opens), "l", "0")),
Last_Week = ifelse(Week == max(Week), "1", "0"))
news.o %>%
# visualizing
ggplot(aes(Week, Opens, group = 1)) +
geom_line(stat = "identity", color = G.line_main_col, size = G.line_size) +
geom_text(aes(label = Opens), fontface = "bold",
vjust = ifelse(news.o$High_Low == "h", G.label_pos_h, G.label_pos_l),
hjust = ifelse(news.o$Last_Week == "1", G.label_pos_last, 0),
size = ifelse(news.o$High_Low != "0" | news.o$Last_Week == "1", G.label_size_h, 0),
color = ifelse(news.o$High_Low == "h", G.label_h_col,
ifelse(news.o$High_Low == "l", G.label_l_col, G.label_last_col))) +
G.my_theme
